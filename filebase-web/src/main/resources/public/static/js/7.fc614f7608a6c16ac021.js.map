{"version":3,"sources":["webpack:///src/pages/signup/signup.vue","webpack:///./src/pages/signup/signup.vue?0aa6","webpack:///./src/pages/signup/signup.vue"],"names":["signup","data","dialogFormVisible","frm","userCode","password","role","roles","showForVisble","roleCode","key","authUser","rules","username","required","message","trigger","computed","serverUrl","mounted","this","initRoles","methods","extends_default","Object","vuex_esm","login","mutation_types","_this","$http","get","then","resp","result","options","console","log","signin","_this2","app","$refs","validate","valid","post","response","roleNum","code","secLogin","$message","error","_this3","localStorage","setItem","authCode","account","nickname","stringify_default","userResourceKeys","m","i","length","userResourceKeyMap","$router","push","name","components","signup_signup","render","_vm","_h","$createElement","_c","_self","attrs","id","_e","directives","rawName","staticClass","type","nativeOn","click","$event","_v","title","visible","width","on","update:visible","ref","label-position","model","label","prop","placeholder","value","callback","$$v","$set","expression","keyup","_k","keyCode","slot","preventDefault","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/7.fc614f7608a6c16ac021.js","sourcesContent":["<template>\n  <main id=\"bg\">\n    <el-button v-if=\"!dialogFormVisible\" type=\"text\" class=\"hh\" @click.native=\"dialogFormVisible = true\" v->登录\n    </el-button>\n    <el-dialog title=\"登录\" :visible.sync=\"dialogFormVisible\" width=\"30%\">\n      <el-form label-position=\"top\" :model=\"frm\" :rules=\"rules\" ref=\"frm\">\n        <el-form-item label=\"\" prop=\"account\">\n          <el-input v-model=\"frm.userCode\" placeholder=\"用户名\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"\" prop=\"password\">\n          <el-input type=\"password\" v-model=\"frm.password\" placeholder=\"密码\" @keyup.native.enter=\"signin\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"\" prop=\"repassword\">\n          <el-input type=\"password\" v-model=\"frm.repassword\" placeholder=\"确认密码\" @keyup.native.enter=\"signin\"></el-input>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click.native.prevent=\"signup\">注册</el-button>\n    </span>\n    </el-dialog>\n  </main>\n\n</template>\n\n<script>\n  import * as types from '../../store/mutation-types'\n  import {mapActions} from 'vuex'\n\n  export default {\n    data () {\n      return {\n        dialogFormVisible: true,\n        frm: {\n          userCode: '',\n          password: ''\n        },\n        role: {\n          roles: [],\n          showForVisble: false,\n          roleCode: '',\n          key: ''\n        },\n        authUser: {},\n        rules: {\n          username: [\n            {required: true, message: '请输入账号', trigger: 'blur'}\n          ],\n          password: [\n            {required: true, message: '请输入密码', trigger: 'change'}\n          ]\n        }\n      }\n    },\n    computed: {\n      serverUrl: function () {\n        switch (process.env.NODE_ENV) {\n          case 'production':\n            return ''\n          default:\n            return 'http://localhost:8089'\n        }\n      }\n    },\n    mounted () {\n      this.initRoles()\n    },\n    methods: {\n      ...mapActions({\n        login: types.ACTION_USER_LOGIN // 将 `this.add()` 映射为 `this.$store.dispatch('increment')`\n      }),\n      initRoles () {\n        this.$http.get(`${this.serverUrl}/admin/sys/role/listAll`).then((resp) => {\n          if (resp.data.result === 'success') {\n            this.options = resp.data.data\n          }\n        }, (resp) => {\n          console.log('初始化角色出错', resp)\n        })\n      },\n      signin () {\n        let app = this\n        app.$refs.frm.validate((valid) => {\n          if (valid) {\n            app.$http.post('admin/user/login',\n              {userCode: this.frm.userCode, password: this.frm.password}).then((response) => {\n              // 登录成功,写入数据到session 以及vuex\n              let data = response.data.data\n              app.authUser = data.authUser\n              app.role.key = data.key\n              if (data.roleNum === 0) {\n                app.$message('你没有绑定过角色无法登陆')\n                return\n              }\n              if (data.roleNum === 1) {\n                // 直接请求选择角色确认方法\n                app.role.roleCode = data.roles[0].code\n                app.secLogin()\n              } else {\n                app.role.roles = data.roles\n                app.role.showForVisble = true\n              }\n            }, (error) => {\n              console.log(error)\n            })\n            return true\n          }\n          return false\n        })\n      },\n      secLogin () {\n        let app = this\n        app.$http.post('admin/user/realLogin', {key: this.role.key, roleCode: this.role.roleCode}).then((response) => {\n          let data = response.data.data\n          localStorage.setItem('authCode', data.authCode)\n          localStorage.setItem('account', data.account)\n          localStorage.setItem('nickname', data.nickname)\n          localStorage.setItem('roleCode', data.roleCode)\n          localStorage.setItem('userResourceKeys', JSON.stringify(data.userResourceKeys))\n          var m = {}\n          for (var i = 0; i < data.userResourceKeys.length; i++) {\n            m[data.userResourceKeys[i]] = true\n          }\n          localStorage.setItem('userResourceKeyMap', JSON.stringify(m))\n          response.data.data.userResourceKeyMap = m\n          // vuex\n          this.login(data)\n          // 路由\n          this.$router.push({name: 'home'})\n        }, (error) => {\n          console.log(error)\n        })\n      }\n    },\n    components: {}\n  }\n</script>\n\n<style lang=\"css\" scoped>\n  main {\n    padding: 20px;\n    background-color: #475669;\n    background-size: cover;\n    background-repeat: no-repeat;\n    background-position: 50% 50%;\n    height: 100vh;\n  }\n\n  .hh {\n    color: #fff;\n    border: 1px solid #fff;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/signup/signup.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',{attrs:{\"id\":\"bg\"}},[(!_vm.dialogFormVisible)?_c('el-button',{directives:[{name:\"\",rawName:\"v-\"}],staticClass:\"hh\",attrs:{\"type\":\"text\"},nativeOn:{\"click\":function($event){_vm.dialogFormVisible = true}}},[_vm._v(\"登录\\n  \")]):_vm._e(),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"登录\",\"visible\":_vm.dialogFormVisible,\"width\":\"30%\"},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event}}},[_c('el-form',{ref:\"frm\",attrs:{\"label-position\":\"top\",\"model\":_vm.frm,\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"label\":\"\",\"prop\":\"account\"}},[_c('el-input',{attrs:{\"placeholder\":\"用户名\"},model:{value:(_vm.frm.userCode),callback:function ($$v) {_vm.$set(_vm.frm, \"userCode\", $$v)},expression:\"frm.userCode\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"\",\"prop\":\"password\"}},[_c('el-input',{attrs:{\"type\":\"password\",\"placeholder\":\"密码\"},nativeOn:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.signin($event)}},model:{value:(_vm.frm.password),callback:function ($$v) {_vm.$set(_vm.frm, \"password\", $$v)},expression:\"frm.password\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"\",\"prop\":\"repassword\"}},[_c('el-input',{attrs:{\"type\":\"password\",\"placeholder\":\"确认密码\"},nativeOn:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.signin($event)}},model:{value:(_vm.frm.repassword),callback:function ($$v) {_vm.$set(_vm.frm, \"repassword\", $$v)},expression:\"frm.repassword\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.signup($event)}}},[_vm._v(\"注册\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6f43e19d\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/signup/signup.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6f43e19d\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./signup.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./signup.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./signup.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6f43e19d\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./signup.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6f43e19d\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/signup/signup.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}