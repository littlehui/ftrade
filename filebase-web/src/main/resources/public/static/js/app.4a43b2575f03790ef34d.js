webpackJsonp([17],{"30Mn":function(e,t){},"5BXs":function(e,t,n){var r={"./app/app-manager":["8w0F",0,10],"./app/app-manager.vue":["8w0F",0,10],"./app/app-role":["h/hZ",0,1],"./app/app-role.vue":["h/hZ",0,1],"./appInfo/appInfo":["5NNi",0,12],"./appInfo/appInfo.vue":["5NNi",0,12],"./bak/file/file":["PB+R",0,8],"./bak/file/file.vue":["PB+R",0,8],"./bak/log/log":["Ray/",0,9],"./bak/log/log.vue":["Ray/",0,9],"./bak/pd/apply":["F4Gm",15],"./bak/pd/apply.vue":["F4Gm",15],"./bak/pd/history":["375/",0,2],"./bak/pd/history.vue":["375/",0,2],"./bak/pd/pd":["z0Bt",0,14],"./bak/pd/pd.vue":["z0Bt",0,14],"./bak/result/list":["MF1L",0,6],"./bak/result/list.vue":["MF1L",0,6],"./bak/sys/resource":["bj8f",0,13],"./bak/sys/resource.vue":["bj8f",0,13],"./bak/sys/role":["K2CU",0,3],"./bak/sys/role.vue":["K2CU",0,3],"./bak/sys/user":["VQRf",0,4],"./bak/sys/user.vue":["VQRf",0,4],"./consumer/available-list":["+iRx",0,5],"./consumer/available-list.vue":["+iRx",0,5],"./consumer/init-list":["UeK2",0,11],"./consumer/init-list.vue":["UeK2",0,11],"./home":["vkyI"],"./home.vue":["vkyI"],"./signin":["dxeE"],"./signin.vue":["dxeE"],"./signup/signup":["rHLy",7],"./signup/signup.vue":["rHLy",7]};function o(e){var t=r[e];return t?Promise.all(t.slice(1).map(n.e)).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}o.keys=function(){return Object.keys(r)},o.id="5BXs",e.exports=o},"Du/2":function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"f",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return i});var r="USER_LOGIN",o="USER_LOGOUT",a="AUTH_CODE_SET",s="AUTH_MENU_LIST_SET",u="ACTION_USER_LOGIN",i="ACTION_USER_LOGOUT"},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("//Fk"),o=n.n(r),a=n("7+uW"),s=n("BO1k"),u=n.n(s),i=n("M4fF"),l=n.n(i),c=n("vkyI"),d=function(e){var t=[],r=!0,o=!1,a=void 0;try{for(var s,i=u()(e);!(r=(s=i.next()).done);r=!0){var c=s.value,d=l.a.cloneDeep(c.subMenus),f=function(e){if(e.url){var r={},o=[],a=e.name;e.title&&(a=e.title),o.push({title:a}),r.breadcrumbs=o,t.push({name:e.name,path:c.url+e.url,meta:r,component:function(){return n("5BXs")("./"+e.pageLocation)}})}else{var s=function(e){var r={},o=[],a=e.name;e.activeMenu&&(r.activeMenu=e.activeMenu),e.breadcrumbs&&(o=e.breadcrumbs),e.title&&(a=e.title),o.push({title:a}),r.breadcrumbs=o;var s={name:e.name,path:c.url+e.url,meta:r,component:function(){return n("5BXs")("./"+e.pageLocation)}};t.push(s)},i=!0,l=!1,d=void 0;try{for(var f,m=u()(e.subMenus);!(i=(f=m.next()).done);i=!0)s(f.value)}catch(e){l=!0,d=e}finally{try{!i&&m.return&&m.return()}finally{if(l)throw d}}}},m=!0,p=!1,h=void 0;try{for(var v,g=u()(d);!(m=(v=g.next()).done);m=!0)f(v.value)}catch(e){p=!0,h=e}finally{try{!m&&g.return&&g.return()}finally{if(p)throw h}}}}catch(e){o=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw a}}return{route:t}}(n("dPBJ"));d.route=d.route.concat([{path:"/",name:"home",meta:{withoutAuth:!1},component:c.default}]);var f,m,p=d.route,h=n("/ocq"),v=n("NYxO"),g=n("bOdI"),b=n.n(g),y=n("Du/2"),M={state:{account:"CY6034",nickname:"littlehui",roleCode:"Admin",authCode:"Admin",userResourceKeys:["consumer:manager"],userResourceKeyMap:{}},getters:{isLogin:function(e){return""!==e.authCode},nickname:function(e){return e.nickname},roleCode:function(e){return e.roleCode},userResourceKeys:function(e){return e.userResourceKeys},authCode:function(e){return e.authCode},userResourceKeyMap:function(e){return e.userResourceKeyMap}},actions:(f={},b()(f,y.a,function(e,t){(0,e.commit)(y.e,t)}),b()(f,y.b,function(e,t){(0,e.commit)(y.f,t)}),f),mutations:(m={},b()(m,y.e,function(e,t){var n=t.account,r=t.nickname,o=t.authCode,a=t.roleCode,s=t.userResourceKeys,u=t.userResourceKeyMap;e.account=n,e.nickname=r,e.authCode=o,e.roleCode=a,e.userResourceKeys=s,e.userResourceKeyMap=u}),b()(m,y.f,function(e){e.account="",e.nickname="",e.authCode="",e.userResourceKeys=[],e.roleCode="",e.userResourceKeyMap={}}),b()(m,y.c,function(e){}),b()(m,y.d,function(e){}),m)};n("fZjL"),n("pFYg");a.default.use(v.a);var k=new v.a.Store({modules:{user:M},strict:!1,plugins:[]}),C=localStorage.getItem("userResourceKeys")||"[]",_=localStorage.getItem("userResourceKeyMap")||"{}",R={account:localStorage.getItem("account")||"",nickname:localStorage.getItem("nickname")||"",authCode:localStorage.getItem("authCode")||"",roleCode:localStorage.getItem("roleCode")||"",userResourceKeys:JSON.parse(C),userResourceKeyMap:JSON.parse(_)};k.dispatch(y.a,R);var L=k,x=n("mtWM"),I=n.n(x),w=n("Rf8U"),K=n.n(w),S=n("zL8q"),O=n.n(S),U=(n("tvR6"),n("Dd8w")),F=n.n(U),$=n("dPBJ"),N={name:"App",watch:{$route:"resetTopMenuIndex"},computed:F()({},Object(v.c)(["isLogin","nickname","userResourceKeys","roleCode","userResourceKeyMap"]),{topMenuList:function(){var e=[];if(""===this.roleCode)return e;for(var t=0;t<$.length;t++)this.userResourceKeyMap[$[t].resourceKey]&&e.push({title:$[t].title,index:$[t].name,url:$[t].url});return e},defaultTopMenuActive:function(){var e=this.$route.path;if(0!==this.topMenuList.length){for(var t=0;t<this.topMenuList.length;t++)if(e.startsWith(this.topMenuList[t].url))return this.topMenuList[t].index;return this.topMenuList[0].index}},defaultLeftMenuActive:function(){return this.$route.path},defaultLeftMenuName:function(){return this.leftMenuList.length>0?this.leftMenuList[0].name:""},leftMenuList:function(){var e=[];if(this.topMenuList.length<1)return e;for(var t=0;t<$.length;t++)if(this.topMenuIndex===$[t].name)for(var n=0;n<$[t].subMenus.length;n++)this.userResourceKeyMap[$[t].subMenus[n].resourceKey]&&e.push({title:$[t].subMenus[n].title,index:$[t].url+$[t].subMenus[n].url,name:$[t].subMenus[n].name});return e}}),methods:F()({},Object(v.b)({logout:y.b}),{resetTopMenuIndex:function(){for(var e=this.$route.path,t=0;t<this.topMenuList.length;t++)e.startsWith(this.topMenuList[t].url)&&(this.topMenuIndex=this.topMenuList[t].index)},handleCommand:function(e){var t=this;"logout"===e&&(this.$http.post("admin/user/logout").then(function(e){t.logout()},function(e){console.log(e)}),localStorage.setItem("account",""),localStorage.setItem("nickname",""),localStorage.setItem("authCode",""),localStorage.setItem("userResourceKeys","[]"),localStorage.setItem("userResourceKeyMap","{}"))},handleSelect:function(e){this.topMenuIndex=e,this.defaultLeftMenuName&&this.$router.push({name:this.defaultLeftMenuName})},handleSelectLeftMenu:function(e){console.log("left menu",e)},changeUrl:function(){window.location.href="/auth/index.html#/"}}),data:function(){return{topMenuIndex:"file-message"}},mounted:function(){}},E={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.isLogin?n("div",[n("el-container",[n("el-header",{attrs:{height:"80px"}},[n("div",{staticClass:"navbar-header"},[n("a",{staticClass:"navbar-brand",attrs:{href:"/"}},[e._v("FTRADE"),n("span",[e._v("1.0")])])]),e._v(" "),n("div",{staticClass:"navbar-menu"},[n("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.defaultTopMenuActive,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},e._l(e.topMenuList,function(t){return n("el-menu-item",{key:t.index,attrs:{index:t.index}},[e._v(e._s(t.title))])}))],1),e._v(" "),n("div",{staticClass:"navbar-user"},[n("el-dropdown",{attrs:{"split-button":"",type:"plain"},on:{command:e.handleCommand}},[e._v("\n            "+e._s(e.nickname)+"\n            "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出")])],1)],1)],1),e._v(" "),n("div",{staticClass:"navbar-change"},[n("el-button",{attrs:{type:"plain",icon:"el-icon-sort"},on:{click:e.changeUrl}},[e._v("切换权限管理后台")])],1)]),e._v(" "),n("el-container",[n("el-aside",[n("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.defaultLeftMenuActive,"background-color":"#D3DCE6",router:!0},on:{select:e.handleSelectLeftMenu}},e._l(e.leftMenuList,function(t){return n("el-menu-item",{key:t.index,attrs:{index:t.index}},[e._v(e._s(t.title))])}))],1),e._v(" "),n("el-container",[n("el-main",[n("router-view")],1),e._v(" "),n("el-footer",{staticStyle:{height:"0px"}})],1)],1)],1)],1):n("div",[n("signin")],1)])},staticRenderFns:[]};var T=n("VU/8")(N,E,!1,function(e){n("Tuhf")},null,null).exports,A=n("dxeE");a.default.config.productionTip=!1,a.default.use(h.a),a.default.use(K.a,I.a),a.default.use(O.a),a.default.component("signin",A.default);var j=new h.a({routes:p}),V=new a.default({el:"#app",router:j,store:L,components:{App:T},template:"<App/>"});I.a.defaults.baseURL="",I.a.interceptors.request.use(function(e){return L.state.user.authCode&&(e.headers.Authorization=""+L.state.user.authCode),e},function(e){return o.a.reject(e)}),I.a.interceptors.response.use(function(e){if(200===e.status&&"success"!==e.data.result){var t=e.data.messages.join(" ");return V.$message(t),o.a.reject(new Error(t))}return e},function(e){return e.response?(401===e.response.status?L.dispatch(y.b).then(function(){localStorage.setItem("account",""),localStorage.setItem("nickname",""),localStorage.setItem("authCode",""),localStorage.setItem("roleCode",""),localStorage.setItem("userResourceKeys","[]"),localStorage.setItem("userResourceKeyMap","{}")}):403===e.response.status?V.$message("未授权,请联系管理员"):V.$message("服务错误:"+e.response.status+" "+e.response.statusText),o.a.reject(e)):o.a.reject(e)})},Qwnk:function(e,t){},Tuhf:function(e,t){},dPBJ:function(e,t){e.exports=[{name:"consumer-manager",title:"客户管理",url:"/consumer",resourceKey:"consumer:manager",priority:1,subMenus:[{title:"初始客户",name:"consumer-init-list",url:"/consumer-init-list",resourceKey:"consumer:manager:init-list",priority:11,pageLocation:"consumer/init-list.vue"},{title:"正常客户",name:"consumer-available-list",url:"/consumer-available-list",resourceKey:"consumer:manager:availableList",priority:12,pageLocation:"consumer/available-list.vue"}]}]},dxeE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("mvHQ"),o=n.n(r),a=n("Dd8w"),s=n.n(a),u=n("Du/2"),i=n("NYxO"),l={data:function(){return{dialogFormVisible:!0,frm:{userCode:"",password:""},role:{roles:[],showForVisble:!1,roleCode:"",key:""},authUser:{},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"change"}]}}},computed:{serverUrl:function(){return""}},mounted:function(){this.initRoles()},methods:s()({},Object(i.b)({login:u.a}),{initRoles:function(){var e=this;this.$http.get(this.serverUrl+"/admin/sys/role/listAll").then(function(t){"success"===t.data.result&&(e.options=t.data.data)},function(e){console.log("初始化角色出错",e)})},signin:function(){var e=this,t=this;t.$refs.frm.validate(function(n){return!!n&&(t.$http.post("admin/user/login",{userCode:e.frm.userCode,password:e.frm.password}).then(function(e){var n=e.data.data;t.authUser=n.authUser,t.role.key=n.key,0!==n.roleNum?1===n.roleNum?(t.role.roleCode=n.roles[0].code,t.secLogin()):(t.role.roles=n.roles,t.role.showForVisble=!0):t.$message("你没有绑定过角色无法登陆")},function(e){console.log(e)}),!0)})},secLogin:function(){var e=this;this.$http.post("admin/user/realLogin",{key:this.role.key,roleCode:this.role.roleCode}).then(function(t){var n=t.data.data;localStorage.setItem("authCode",n.authCode),localStorage.setItem("account",n.account),localStorage.setItem("nickname",n.nickname),localStorage.setItem("roleCode",n.roleCode),localStorage.setItem("userResourceKeys",o()(n.userResourceKeys));for(var r={},a=0;a<n.userResourceKeys.length;a++)r[n.userResourceKeys[a]]=!0;localStorage.setItem("userResourceKeyMap",o()(r)),t.data.data.userResourceKeyMap=r,e.login(n),e.$router.push({name:"home"})},function(e){console.log(e)})}}),components:{}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{attrs:{id:"bg"}},[e.dialogFormVisible?e._e():n("el-button",{directives:[{name:"",rawName:"v-"}],staticClass:"hh",attrs:{type:"text"},nativeOn:{click:function(t){e.dialogFormVisible=!0}}},[e._v("登录\n  ")]),e._v(" "),n("el-dialog",{attrs:{title:"登录",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{ref:"frm",attrs:{"label-position":"top",model:e.frm,rules:e.rules}},[n("el-form-item",{attrs:{label:"",prop:"account"}},[n("el-input",{attrs:{placeholder:"用户名"},model:{value:e.frm.userCode,callback:function(t){e.$set(e.frm,"userCode",t)},expression:"frm.userCode"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"",prop:"password"}},[n("el-input",{attrs:{type:"password",placeholder:"密码"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signin(t):null}},model:{value:e.frm.password,callback:function(t){e.$set(e.frm,"password",t)},expression:"frm.password"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.signin(t)}}},[e._v("登录")])],1),e._v(" "),n("el-dialog",{attrs:{title:"选择角色",visible:e.role.showForVisble,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.$set(e.role,"showForVisble",t)}}},[n("el-form",{ref:"frm",staticStyle:{"margin-left":"140px"},attrs:{"label-position":"top",model:e.frm,rules:e.rules}},[n("el-form-item",{attrs:{label:""}},[n("el-select",{attrs:{placeholder:"请选择用户角色"},model:{value:e.role.roleCode,callback:function(t){e.$set(e.role,"roleCode",t)},expression:"role.roleCode"}},e._l(e.role.roles,function(e){return n("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}))],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.secLogin(t)}}},[e._v("确认")])],1)],1)],1)],1)},staticRenderFns:[]};var d=n("VU/8")(l,c,!1,function(e){n("Qwnk")},"data-v-fac7ad20",null);t.default=d.exports},tvR6:function(e,t){},vkyI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hello"},[t("h1",[this._v(this._s(this.msg))])])},staticRenderFns:[]};var o=n("VU/8")({name:"HelloWorld",data:function(){return{msg:"欢迎!"}}},r,!1,function(e){n("30Mn")},"data-v-57354bbe",null);t.default=o.exports}},["NHnr"]);
//# sourceMappingURL=app.4a43b2575f03790ef34d.js.map