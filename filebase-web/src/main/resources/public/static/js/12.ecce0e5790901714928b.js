webpackJsonp([12],{"5NNi":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),i=a.n(n),o=a("M4fF"),l=a.n(o),p=a("PJh5"),r=a.n(p),s=a("NYxO"),u={data:function(){return{formLabelWidth:"120px",params:{pagination:{pageNo:1,pageSize:20,totalCount:100},query:{appName:"",deleted:!1}},logList:[],deleteList:[{value:!1,label:"正常"},{value:!0,label:"删除"}],add:{dialogTitle:"增加app",bucketVisible:!1,appInfo:{appName:"",bucket:"",cdnDomain:"",signNeed:!1,signKey:"",key:"",remark:""}},upt:{dialogTitle:"修改app",bucketVisible:!1,appInfo:{id:"",appName:"",remark:""}},key:{dialogTitle:"key信息",keyVisible:!1,keyValue:"",keyId:"",isEdit:!1},options:[{value:!1,label:"否"},{value:!0,label:"是"}]}},computed:i()({queryCondition:function(){var e=l.a.assign({},this.params.pagination);return e=l.a.assign(e,this.params.query)},uptCondition:function(){var e=l.a.assign({},this.upt.appInfo);return e=l.a.assign(e,this.upt.appInfo)}},Object(s.c)(["isLogin","nickname","userResourceKeys","roleCode","userResourceKeyMap"])),mounted:function(){this.fetchList()},attached:function(){},methods:{formatDate:function(e,t){return null===e[t.property]?"-":r()(e[t.property]).format("YYYY-MM-DD HH:mm")},formatDelete:function(e,t){return!0===e[t.property]?"删除":"正常"},formatBoolean:function(e,t){return!0===e[t.property]?"是":"否"},handleSizeChange:function(e){this.params.pagination.pageSize=e,this.fetchList()},handleCurrentChange:function(e){this.params.pagination.pageNo=e,this.fetchList()},fetchList:function(){var e=this;this.$http.get("admin/app/list",{params:this.queryCondition}).then(function(t){e.logList=t.data.data.listData,e.params.pagination.totalCount=t.data.data.totalCount},function(e){console.log(e)})},resetPageNoQuery:function(){this.params.pagination.pageNo=1,this.fetchList()},delBucket:function(e){var t=this;this.$confirm("此操作将永久删除app的存储空间，app下的文件将无法获取, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post("admin/app/delBucket?id="+e.id).then(function(e){t.$message("删除成功"),t.fetchList()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},recovery:function(e){var t=this;this.$confirm("你确定要重新使用该app吗, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post("admin/app/recoveryBucket?id="+e).then(function(e){t.$message("恢复成功"),t.fetchList()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},showVideoWin:function(){this.add.appInfo.appName="",this.add.appInfo.bucket="",this.add.appInfo.key="",this.add.appInfo.remark="",this.add.appInfo.cdnDomain="",this.add.appInfo.signNeed=!1,this.add.appInfo.signKey="",this.add.bucketVisible=!0},addBucket:function(){var e=this,t=this.add.appInfo.bucket;/^[a-z0-9]{1,20}$/.test(t)?this.$http.get("admin/app/save",{params:this.add.appInfo}).then(function(t){e.$message("增加成功"),e.fetchList(),e.add.bucketVisible=!1},function(e){console.log(e)}):this.$message("bucket只能为小写和数字且少于20")},getKey:function(){var e=this;this.$http.post("admin/app/getRandomKey").then(function(t){e.add.appInfo.key=t.data.data})},showUptDialog:function(e){this.upt.appInfo.id=e.id,this.upt.appInfo.appName=e.appName,this.upt.appInfo.remark=e.remark,this.upt.bucketVisible=!0},uptBucket:function(){var e=this;this.$http.get("admin/app/uptBucket",{params:this.uptCondition}).then(function(t){e.$message("修改成功"),e.fetchList(),e.upt.bucketVisible=!1},function(e){console.log(e)})},showKey:function(e){var t=this;this.key.keyId=e,this.$http.get("admin/app/getKey?appId="+e).then(function(e){t.key.keyValue=e.data.data,t.key.isEdit=!0,t.key.keyVisible=!0},function(e){console.log(e)})},uptSecret:function(){var e=this;this.$http.get("admin/app/updateKey?id="+this.key.keyId+"&key="+this.key.keyValue).then(function(t){e.$message("修改成功"),e.key.keyVisible=!1},function(e){console.log(e)})}},components:{}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("文件管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("app信息")])],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-form",{attrs:{inline:!0}},[a("div",{staticClass:"queryForm"},[a("el-form-item",[a("el-input",{attrs:{placeholder:"appName"},model:{value:e.params.query.appName,callback:function(t){e.$set(e.params.query,"appName",t)},expression:"params.query.appName"}})],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"状态"},model:{value:e.params.query.deleted,callback:function(t){e.$set(e.params.query,"deleted",t)},expression:"params.query.deleted"}},e._l(e.deleteList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{nativeOn:{click:function(t){return t.preventDefault(),e.resetPageNoQuery(t)}}},[a("i",{staticClass:"fa fa-search",attrs:{"aria-hidden":"true"}}),e._v("\n            查询\n          ")])],1)],1),e._v(" "),a("div",{staticClass:"addOperate"},[this.userResourceKeyMap["file:manager:app:add"]?a("el-button",{nativeOn:{click:function(t){return t.preventDefault(),e.showVideoWin(t)}}},[a("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}}),e._v("\n          新建app\n        ")]):e._e()],1)])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.logList,stripe:"",border:""}},[a("el-table-column",{attrs:{property:"appId",label:"appId"}}),e._v(" "),a("el-table-column",{attrs:{property:"appName",label:"app名称"}}),e._v(" "),a("el-table-column",{attrs:{property:"bucket",label:"bucket"}}),e._v(" "),a("el-table-column",{attrs:{property:"cdnDomain",label:"cdn域名"}}),e._v(" "),a("el-table-column",{attrs:{property:"signNeed",label:"是否需要cdn鉴权",formatter:e.formatBoolean}}),e._v(" "),a("el-table-column",{attrs:{property:"signKey",label:"鉴权key"}}),e._v(" "),a("el-table-column",{attrs:{property:"region",label:"区域"}}),e._v(" "),a("el-table-column",{attrs:{property:"createTime",label:"创建时间",formatter:e.formatDate}}),e._v(" "),a("el-table-column",{attrs:{property:"deleted",label:"状态",formatter:e.formatDelete}}),e._v(" "),a("el-table-column",{attrs:{property:"remark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.userResourceKeyMap["file:manager:app:uptede"]&&!t.row.deleted?a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),e.showUptDialog(t.row)}}},[e._v("修改\n        ")]):e._e(),e._v(" "),e.userResourceKeyMap["file:manager:app:delete"]&&!t.row.deleted?a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),e.delBucket(t.row)}}},[e._v("删除\n        ")]):e._e(),e._v(" "),e.userResourceKeyMap["file:manager:app:showKey"]&&!t.row.deleted?a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),e.showKey(t.row.appId)}}},[e._v("查看key\n        ")]):e._e(),e._v(" "),e.userResourceKeyMap["file:manager:app:recovery"]&&t.row.deleted?a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),e.recovery(t.row.id)}}},[e._v("恢复使用\n        ")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"page-block"},[a("el-pagination",{attrs:{"current-page":e.params.pagination.pageNo,"page-sizes":[20,50,100,200],"page-size":e.params.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.params.pagination.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.add.dialogTitle,visible:e.add.bucketVisible},on:{"update:visible":function(t){e.$set(e.add,"bucketVisible",t)}}},[a("el-form",{ref:"form",staticClass:"demo-form-inline",attrs:{model:e.add.appInfo}},[a("el-form-item",{attrs:{label:"app名称","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.add.appInfo.appName,callback:function(t){e.$set(e.add.appInfo,"appName",t)},expression:"add.appInfo.appName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"bucket","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.add.appInfo.bucket,callback:function(t){e.$set(e.add.appInfo,"bucket",t)},expression:"add.appInfo.bucket"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"cdn域名","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.add.appInfo.cdnDomain,callback:function(t){e.$set(e.add.appInfo,"cdnDomain",t)},expression:"add.appInfo.cdnDomain"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"需要cdn鉴权","label-width":e.formLabelWidth}},[[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.add.appInfo.signNeed,callback:function(t){e.$set(e.add.appInfo,"signNeed",t)},expression:"add.appInfo.signNeed"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]],2),e._v(" "),a("el-form-item",{attrs:{label:"鉴权key","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.add.appInfo.signKey,callback:function(t){e.$set(e.add.appInfo,"signKey",t)},expression:"add.appInfo.signKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密钥","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.add.appInfo.key,callback:function(t){e.$set(e.add.appInfo,"key",t)},expression:"add.appInfo.key"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},nativeOn:{click:function(t){return t.preventDefault(),e.getKey(t)}},slot:"append"},[e._v("自动生成")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.add.appInfo.remark,callback:function(t){e.$set(e.add.appInfo,"remark",t)},expression:"add.appInfo.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.add.bucketVisible=!1}}},[e._v("关 闭")]),e._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.addBucket(t)}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.upt.dialogTitle,visible:e.upt.bucketVisible},on:{"update:visible":function(t){e.$set(e.upt,"bucketVisible",t)}}},[a("el-form",{ref:"form",staticClass:"demo-form-inline",attrs:{model:e.upt.appInfo}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.upt.appInfo.id,expression:"upt.appInfo.id"}],attrs:{type:"hidden"},domProps:{value:e.upt.appInfo.id},on:{input:function(t){t.target.composing||e.$set(e.upt.appInfo,"id",t.target.value)}}}),e._v(" "),a("el-form-item",{attrs:{label:"app名称","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.upt.appInfo.appName,callback:function(t){e.$set(e.upt.appInfo,"appName",t)},expression:"upt.appInfo.appName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.upt.appInfo.remark,callback:function(t){e.$set(e.upt.appInfo,"remark",t)},expression:"upt.appInfo.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.upt.bucketVisible=!1}}},[e._v("关 闭")]),e._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.uptBucket(t)}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.key.dialogTitle,visible:e.key.keyVisible},on:{"update:visible":function(t){e.$set(e.key,"keyVisible",t)}}},[a("el-form",{ref:"form",staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"key","label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"500px"},attrs:{disabled:e.key.isEdit},model:{value:e.key.keyValue,callback:function(t){e.$set(e.key,"keyValue",t)},expression:"key.keyValue"}})],1),e._v(" "),a("el-form-item",[e.key.isEdit?a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){t.preventDefault(),e.key.isEdit=!1}}},[e._v("编 辑")]):e._e(),e._v(" "),e.key.isEdit?e._e():a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.uptSecret(t)}}},[e._v("提 交")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.key.keyVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(u,d,!1,function(e){a("EnFY")},"data-v-3f655311",null);t.default=c.exports},EnFY:function(e,t){}});
//# sourceMappingURL=12.ecce0e5790901714928b.js.map